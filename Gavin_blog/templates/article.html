{% extends "base.html"%}
{% block block_1 %}
    <div class="top_article">
        <div class="article_1"></div>
        <div class="top_article_2">
            {#  左边公示栏  #}
            <div class="col-md-3 article_left">
                {#    日历     #}
                <div class="calendar bg-success">
                    日历
                </div>
                {#    分类     #}
                <div class="bg-success classify">
                    {% for foo in article_2.classify %}
                        <a class="classify_1" href="\classify_article\{{ foo.0 }}">{{ foo.0 }}({{ foo.1 }})</a>
                    {% endfor %}
                </div>
            </div>
            {#       内容部分        #}
            <div class="col-md-9">
                <div class="article_title_content_time" id="article_title_content_time" nid = {{ article_2.nid }}>
                    {#标题#}
                    <span class="article_2">{{ article_2.title }}</span>
                    <div class="article_3"></div>
                    {#内容#}
                    <span class="article_4">{{ article_2.content|safe }}</span>
                    {#时间#}
                    <span class="article_5">{{ article_2.time }}</span>
                </div>
                {#评论#}
                <div class="comment" id="comment">
                    {#判断是否有评论表#}
                    {% if article_2.comment %}
                        {% for c in article_2.comment %}
                            <div class="article_6">
                                <span class="comment_name">{{ c.0 }}:</span>
                                <span class="comment_content">{{ c.1 }}</span>
                            </div>
                    {% endfor %}
                    {% endif %}
                </div>
                {#添加评论#}
                <div>
                    {% csrf_token %}
                    <div>
                        <label for="comment_name">用户名:</label>
                        <input type="text" class="form-control new_comment_name" id="new_comment_name" placeholder="用户名">
                    </div>
                    <label for="comment_content">评论：</label>
                    <textarea class="form-control new_comment_content" rows="4" id="new_comment_content" placeholder="评论内容"></textarea>
                    <button class="btn btn-default new_comment_1" id="new_comment">提交</button>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(function () {
            $("#new_comment").click(function () {
                var comment_name = $("#new_comment_name").val();
                var comment_content = $("#new_comment_content").val();
                $.ajax({
                    url:"/create_comment/",
                    type:"post",
                    data:{
                        "csrfmiddlewaretoken":$("[name='csrfmiddlewaretoken']").val(),
                        "comment_name":comment_name,
                        "comment_content":comment_content,
                        "article_nid":$("#article_title_content_time").attr("nid"),
                    },
                    success:function (data) {
                        if(data.succeed){
                            $(".article_6").last().after(
                                "<div class=\"article_6\">\n" +
                                "   <span class=\"comment_name\">"+comment_name+":</span>\n" +
                                "   <span class=\"comment_content\">"+comment_content+"</span>\n" +
                                "</div>")
                            $("#new_comment_name").val("");
                            $("#new_comment_content").val("");
                        }
                    }
                })
            })
        })
    </script>
{% endblock %}